<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Pulling Hi-C data with mariner • mariner</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Pulling Hi-C data with mariner">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mariner</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.9.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/mariner.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/pull_hic.html">Pulling Hi-C data with mariner</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/EricSDavis/mariner/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Pulling Hi-C data with mariner</h1>
                        <h4 data-toc-skip class="author">Eric Davis</h4>
            
            <h4 data-toc-skip class="date">2025-08-05</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/EricSDavis/mariner/blob/main/vignettes/articles/pull_hic.Rmd" class="external-link"><code>vignettes/articles/pull_hic.Rmd</code></a></small>
      <div class="d-none name"><code>pull_hic.Rmd</code></div>
    </div>

    
    
<p><code>mariner</code> offers 2 functions for extracting/pulling
interactions from <code>.hic</code> files - <code><a href="../reference/pullHicPixels.html">pullHicPixels()</a></code>
and <code><a href="../reference/pullHicMatrices.html">pullHicMatrices()</a></code>. In this article, you will learn how
to extract Hi-C pixels or count matrices and access them from the
resulting objects.</p>
<p><code><a href="../reference/pullHicPixels.html">pullHicPixels()</a></code> and <code><a href="../reference/pullHicMatrices.html">pullHicMatrices()</a></code>
accept the same set of arguments, but return different outputs. Which
function you choose depends on whether you want to extract a single
value for each interaction or a matrix of values between a range of
interactions.</p>
<div class="section level2">
<h2 id="when-to-use-pullhicpixels">When to use <code>pullHicPixels()</code><a class="anchor" aria-label="anchor" href="#when-to-use-pullhicpixels"></a>
</h2>
<p>If you want a single value for each interaction and <code>.hic</code>
file then you should use the <code><a href="../reference/pullHicPixels.html">pullHicPixels()</a></code> function. We
define a “pixel” as an interaction where both anchors are the same
width. The <code>binSize</code> argument is used here to check that your
desired pixel resolution matches your input interactions.</p>
<p><img src="img/pixelFigure.png" width="50%" style="display: block; margin: auto;"></p>
<div style="
padding: .5em 1em;
margin-bottom: 10px;
border-radius:5px;
border-left: 5px solid #2780e3;
border-right: 1px solid #dee2e6;
border-top: 1px solid #dee2e6;
border-bottom: 1px solid #dee2e6;
">
<div style="font-weight: 600; opacity: 75%;">
<p style="margin:0px">
Note
</p>
</div>
<p>You can check your <code>.hic</code> file to see which resolutions
are available for the <code>binSize</code> argument with the
<code><a href="https://rdrr.io/pkg/strawr/man/readHicBpResolutions.html" class="external-link">strawr::readHicBpResolutions()</a></code>. See the
<code><a href="../reference/assignToBins.html">assignToBins()</a></code> to set your interactions to an acceptable
resolution.</p>
</div>
<p>The following example pulls 100-Kb pixels from two <code>.hic</code>
files:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Load mariner</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ericscottdavis.com/mariner/" class="external-link">mariner</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Use example .hic files from ExperimentHub</span></span>
<span><span class="va">hicFiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://phanstiellab.github.io/plotgardener/reference/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu">marinerData</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/marinerData/man/LEUK_HEK_PJA27_inter_30.hic.html" class="external-link">LEUK_HEK_PJA27_inter_30.hic</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="fu">marinerData</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/marinerData/man/LEUK_HEK_PJA30_inter_30.hic.html" class="external-link">LEUK_HEK_PJA30_inter_30.hic</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">hicFiles</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://phanstiellab.github.io/plotgardener/reference/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hic1"</span>, <span class="st">"hic2"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Make some example interactions</span></span>
<span><span class="va">gi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span></span>
<span>    text<span class="op">=</span><span class="st">"</span></span>
<span><span class="st">    1 51000000 51100000 1 51000000 51100000</span></span>
<span><span class="st">    1 150000000 150100000 1 150000000 150100000</span></span>
<span><span class="st">    2 51000000 51100000 2 51000000 51100000</span></span>
<span><span class="st">    2 150000000 150100000 2 150000000 150100000</span></span>
<span><span class="st">    "</span></span>
<span><span class="op">)</span></span>
<span><span class="va">gi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_ginteractions.html">as_ginteractions</a></span><span class="op">(</span><span class="va">gi</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Pull Hi-C pixels</span></span>
<span><span class="va">pixels</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pullHicPixels.html">pullHicPixels</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gi</span>, files<span class="op">=</span><span class="va">hicFiles</span>, binSize<span class="op">=</span><span class="fl">100e3</span><span class="op">)</span></span>
<span><span class="va">pixels</span></span></code></pre></div>
<pre><code><span><span class="co">## class: InteractionMatrix </span></span>
<span><span class="co">## dim: count matrix with 4 interactions and 2 file(s)</span></span>
<span><span class="co">## metadata(3): binSize norm matrix</span></span>
<span><span class="co">## assays(1): counts</span></span>
<span><span class="co">## rownames: NULL</span></span>
<span><span class="co">## rowData names(0):</span></span>
<span><span class="co">## colnames(2): hic1 hic2</span></span>
<span><span class="co">## colData names(2): files fileNames</span></span>
<span><span class="co">## type: GInteractions</span></span>
<span><span class="co">## regions: 4</span></span></code></pre>
<p>This results in an <code>InteractionMatrix</code> object which
contains the extracted Hi-C data, interactions, and metadata for the
interactions and <code>.hic</code> files.</p>
<p>The extracted Hi-C data is stored as a count matrix where every row
is an interaction (i.e pixel) and each column is a <code>.hic</code>
file. Use the <code><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts()</a></code> function to access the count matrix
from an <code>InteractionMatrix</code> object.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="va">pixels</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## &lt;4 x 2&gt; DelayedMatrix object of type "double":</span></span>
<span><span class="co">##      hic1 hic2</span></span>
<span><span class="co">## [1,]   53   49</span></span>
<span><span class="co">## [2,]   63   56</span></span>
<span><span class="co">## [3,]   36   16</span></span>
<span><span class="co">## [4,]   43   24</span></span></code></pre>
<p>This count matrix is stored on-disk (if <code>onDisk=TRUE</code>) as
an HDF5-backed <code>DelayedArray</code> object. The data is stored in
the provided file path to the <code>h5File</code> argument. If a file
path isn’t provided, a temporary file is created in the current
Rsession. To access or update the location of the HDF5 file after using
the <code><a href="../reference/pullHicPixels.html">pullHicPixels()</a></code> function, use the <code><a href="https://rdrr.io/pkg/BiocGenerics/man/path.html" class="external-link">path()</a></code>
function.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/path.html" class="external-link">path</a></span><span class="op">(</span><span class="va">pixels</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "/tmp/RtmpdicOqR/file20c24cd87207.h5"</span></span></code></pre>
<div style="
padding: .5em 1em;
margin-bottom: 10px;
border-radius:5px;
border-left: 5px solid #2780e3;
border-right: 1px solid #dee2e6;
border-top: 1px solid #dee2e6;
border-bottom: 1px solid #dee2e6;
">
<div style="font-weight: 600; opacity: 75%;">
<p style="margin:0px">
Note
</p>
</div>
<p>Using a <code>DelayedArray</code> instead of a normal R matrix has a
number of benefits, especially for users working with limited computer
memory. See the <code><a href="https://rdrr.io/pkg/DelayedArray/man/DelayedArray-class.html" class="external-link">?DelayedArray</a></code> package documentation and
vignettes for more information.</p>
</div>
<p>The count matrix can then be used for downstream analysis such as
differential interaction analysis with <code>DESeq2</code>. To learn
more about how to access components of <code>InteractionMatrix</code>
objects, see the <a href="#interaction_matrix_class"><code>InteractionMatrix</code>
class</a> section below.</p>
</div>
<div class="section level2">
<h2 id="when-to-use-pullhicmatrices">When to use <code>pullHicMatrices()</code><a class="anchor" aria-label="anchor" href="#when-to-use-pullhicmatrices"></a>
</h2>
<p>If you want a matrix of values for each interaction then you should
use the <code><a href="../reference/pullHicMatrices.html">pullHicMatrices()</a></code> function. These matrices are made
up of multiple “pixels”, defined by dividing the range of each
interaction by the supplied <code>binSize</code> parameter.</p>
<p><img src="img/matricesFigure.png" width="50%" style="display: block; margin: auto;"></p>
<div class="section level3">
<h3 id="square-matrices">Square matrices<a class="anchor" aria-label="anchor" href="#square-matrices"></a>
</h3>
<p>For example, if you define 500x500 Kb interactions by setting the
width of both anchors to be 500 Kb</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create 500x500 Kb regions</span></span>
<span><span class="va">regions</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/assignToBins.html">assignToBins</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gi</span>, binSize<span class="op">=</span><span class="fl">500e3</span>, pos1<span class="op">=</span><span class="st">"start"</span>, pos2<span class="op">=</span><span class="st">"start"</span><span class="op">)</span></span></code></pre></div>
<p>Then set the <code>binSize</code> to 100 Kb</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Pull Hi-C matrices</span></span>
<span><span class="va">matrices</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pullHicMatrices.html">pullHicMatrices</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">regions</span>, files<span class="op">=</span><span class="va">hicFiles</span>, binSize<span class="op">=</span><span class="fl">100e3</span><span class="op">)</span></span>
<span><span class="va">matrices</span></span></code></pre></div>
<pre><code><span><span class="co">## class: InteractionArray </span></span>
<span><span class="co">## dim: 4 interaction(s), 2 file(s), 5x5 count matrix(es)</span></span>
<span><span class="co">## metadata(3): binSize norm matrix</span></span>
<span><span class="co">## assays(3): counts rownames colnames</span></span>
<span><span class="co">## rownames: NULL</span></span>
<span><span class="co">## rowData names(0):</span></span>
<span><span class="co">## colnames(2): hic1 hic2</span></span>
<span><span class="co">## colData names(2): files fileNames</span></span>
<span><span class="co">## type: GInteractions</span></span>
<span><span class="co">## regions: 4</span></span></code></pre>
<p>It produces count matrices each with 5 rows and 5 columns. These
count matrices are stored in the <code>InteractionArray</code> class and
are accessible with the <code><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts()</a></code> function.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="va">matrices</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## &lt;5 x 5 x 4 x 2&gt; DelayedArray object of type "double":</span></span>
<span><span class="co">## ,,1,hic1</span></span>
<span><span class="co">##      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">## [1,]   53   15    5    1    4</span></span>
<span><span class="co">## [2,]   15   68   19    8    5</span></span>
<span><span class="co">## [3,]    5   19   69   12    2</span></span>
<span><span class="co">## [4,]    1    8   12   48   13</span></span>
<span><span class="co">## [5,]    4    5    2   13   48</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ,,4,hic2</span></span>
<span><span class="co">##      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">## [1,]   24   11    3    7    4</span></span>
<span><span class="co">## [2,]   11   26    2    6    5</span></span>
<span><span class="co">## [3,]    3    2   41   17    4</span></span>
<span><span class="co">## [4,]    7    6   17   42   14</span></span>
<span><span class="co">## [5,]    4    5    4   14   44</span></span></code></pre>
<p>You can supply <code>showDimnames=TRUE</code> to display the start
bin of each anchor.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="va">matrices</span>, showDimnames<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## &lt;5 x 5 x 4 x 2&gt; DelayedArray object of type "double":</span></span>
<span><span class="co">## ,,1,hic1</span></span>
<span><span class="co">##          51000000 51100000 51200000 51300000 51400000</span></span>
<span><span class="co">## 51000000       53       15        5        1        4</span></span>
<span><span class="co">## 51100000       15       68       19        8        5</span></span>
<span><span class="co">## 51200000        5       19       69       12        2</span></span>
<span><span class="co">## 51300000        1        8       12       48       13</span></span>
<span><span class="co">## 51400000        4        5        2       13       48</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ,,4,hic2</span></span>
<span><span class="co">##           150000000 150100000 150200000 150300000 150400000</span></span>
<span><span class="co">## 150000000        24        11         3         7         4</span></span>
<span><span class="co">## 150100000        11        26         2         6         5</span></span>
<span><span class="co">## 150200000         3         2        41        17         4</span></span>
<span><span class="co">## 150300000         7         6        17        42        14</span></span>
<span><span class="co">## 150400000         4         5         4        14        44</span></span></code></pre>
<p>These 4-dimensional arrays use the first and second dimensions as the
rows and columns of the count matrices, the third dimension for each
interaction, and the fourth dimension for each <code>.hic</code>
file.</p>
<p>If you want to convert pixels to square Hi-C regions, you can use the
<code><a href="../reference/pixelsToMatrices.html">pixelsToMatrices()</a></code> function. The <code>buffer</code>
argument describes how many pixels to expand the ranges on either side
of the center pixel. For example, to expand 100x100 Kb pixels to regions
that are 500x500 Kb, specify <code>buffer=2</code> to add two additional
100 Kb pixels on both sides of the central 100 Kb pixels.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regions</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pixelsToMatrices.html">pixelsToMatrices</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gi</span>, buffer<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu">IRanges</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/start.html" class="external-link">width</a></span><span class="op">(</span><span class="va">regions</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $first</span></span>
<span><span class="co">## [1] 500001 500001 500001 500001</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $second</span></span>
<span><span class="co">## [1] 500001 500001 500001 500001</span></span></code></pre>
<p>When pulled with <code><a href="../reference/pullHicMatrices.html">pullHicMatrices()</a></code> using
<code>binSize=100e3</code> odd, 5x5 matrices result.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pullHicMatrices.html">pullHicMatrices</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">regions</span>, files<span class="op">=</span><span class="va">hicFiles</span>, binSize<span class="op">=</span><span class="fl">100e3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## class: InteractionArray </span></span>
<span><span class="co">## dim: 4 interaction(s), 2 file(s), 5x5 count matrix(es)</span></span>
<span><span class="co">## metadata(3): binSize norm matrix</span></span>
<span><span class="co">## assays(3): counts rownames colnames</span></span>
<span><span class="co">## rownames: NULL</span></span>
<span><span class="co">## rowData names(0):</span></span>
<span><span class="co">## colnames(2): hic1 hic2</span></span>
<span><span class="co">## colData names(2): files fileNames</span></span>
<span><span class="co">## type: GInteractions</span></span>
<span><span class="co">## regions: 4</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="rectangular-matrices">Rectangular matrices<a class="anchor" aria-label="anchor" href="#rectangular-matrices"></a>
</h3>
<p>The previous example returns square count matrices where the width of
both anchors are the same for each interaction. <code>mariner</code>
also supports rectangular count matrices where the widths of the rows
and columns are not equal.</p>
<p>For example, you can define 300x600 Kb interactions by setting the
width of the first anchor to be 300 Kb and the second anchor to be 600
Kb.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create 300x600 Kb regions</span></span>
<span><span class="va">regions</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/assignToBins.html">assignToBins</a></span><span class="op">(</span></span>
<span>    x<span class="op">=</span><span class="va">gi</span>,</span>
<span>    binSize<span class="op">=</span><span class="fu"><a href="https://phanstiellab.github.io/plotgardener/reference/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300e3</span>, <span class="fl">600e3</span><span class="op">)</span>,</span>
<span>    pos1<span class="op">=</span><span class="st">"start"</span>,</span>
<span>    pos2<span class="op">=</span><span class="st">"start"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Then set the <code>binSize</code> to 100 Kb</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Pull Hi-C matrices</span></span>
<span><span class="va">matrices</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pullHicMatrices.html">pullHicMatrices</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">regions</span>, files<span class="op">=</span><span class="va">hicFiles</span>, binSize<span class="op">=</span><span class="fl">100e3</span><span class="op">)</span></span>
<span><span class="va">matrices</span></span></code></pre></div>
<pre><code><span><span class="co">## class: InteractionArray </span></span>
<span><span class="co">## dim: 4 interaction(s), 2 file(s), 3x6 count matrix(es)</span></span>
<span><span class="co">## metadata(3): binSize norm matrix</span></span>
<span><span class="co">## assays(3): counts rownames colnames</span></span>
<span><span class="co">## rownames: NULL</span></span>
<span><span class="co">## rowData names(0):</span></span>
<span><span class="co">## colnames(2): hic1 hic2</span></span>
<span><span class="co">## colData names(2): files fileNames</span></span>
<span><span class="co">## type: GInteractions</span></span>
<span><span class="co">## regions: 8</span></span></code></pre>
<p>Which produces an <code>InteractionArray</code> object with count
matrices each with 3 rows and 6 columns.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="va">matrices</span>, showDimnames<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## &lt;3 x 6 x 4 x 2&gt; DelayedArray object of type "double":</span></span>
<span><span class="co">## ,,1,hic1</span></span>
<span><span class="co">##          51000000 51100000 51200000 51300000 51400000 51500000</span></span>
<span><span class="co">## 51000000       53       15        5        1        4        1</span></span>
<span><span class="co">## 51100000       15       68       19        8        5        5</span></span>
<span><span class="co">## 51200000        5       19       69       12        2        2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ,,4,hic2</span></span>
<span><span class="co">##           150000000 150100000 150200000 150300000 150400000 150500000</span></span>
<span><span class="co">## 150000000        24        11         3         7         4         1</span></span>
<span><span class="co">## 150100000        11        26         2         6         5         0</span></span>
<span><span class="co">## 150200000         3         2        41        17         4         9</span></span></code></pre>
<p>Extracting square and rectangular matrices of data results in
<code>InteractionArray</code> objects. See <a href="#interaction_array_class"><code>InteractionArray</code> class</a>
to learn more about accessing data from these objects.</p>
</div>
<div class="section level3">
<h3 id="variable-matrices">Variable matrices<a class="anchor" aria-label="anchor" href="#variable-matrices"></a>
</h3>
<p><code>mariner</code> also supports extracting count matrices that are
different dimensions for each interaction.</p>
<p>For example, these three interactions have dimensions of 1x3, 3x3,
and 3x2 after pulling matrices with a <code>binSize</code> of 100e3:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Interactions of different dimensions</span></span>
<span><span class="va">regions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span></span>
<span>    text<span class="op">=</span><span class="st">"</span></span>
<span><span class="st">    1 51000000 51100000 1 51000000 51300000</span></span>
<span><span class="st">    1 150000000 150300000 1 150000000 150300000</span></span>
<span><span class="st">    2 51000000 51300000 2 51000000 51200000</span></span>
<span><span class="st">    "</span></span>
<span><span class="op">)</span></span>
<span><span class="va">regions</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_ginteractions.html">as_ginteractions</a></span><span class="op">(</span><span class="va">regions</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Pull Hi-C matrices</span></span>
<span><span class="va">matrices</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pullHicMatrices.html">pullHicMatrices</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">regions</span>, files<span class="op">=</span><span class="va">hicFiles</span>, binSize<span class="op">=</span><span class="fl">100e3</span><span class="op">)</span></span>
<span><span class="va">matrices</span></span></code></pre></div>
<pre><code><span><span class="co">## class: InteractionJaggedArray</span></span>
<span><span class="co">## dim: 3 interaction(s), 2 file(s), variable count matrix(es)</span></span>
<span><span class="co">## metadata(3): binSize, norm, matrix</span></span>
<span><span class="co">## colData: hic1, hic2</span></span>
<span><span class="co">## colData names(2): files, fileNames</span></span>
<span><span class="co">## HDF5: /tmp/RtmpdicOqR/file20c230d0ce3.h5</span></span></code></pre>
<p>The resulting object is of class <code>InteractionJaggedArray</code>.
The class is different than the previous examples because the classes
that <code>InteractionArray</code> inherits from are designed for
regular, rectangular data types. A custom class called
<code>JaggedArray</code> is used to hold irregular, or jagged, arrays of
data.</p>
<p>The same <code><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts()</a></code> function returns these
<code>JaggedArray</code> objects containing the Hi-C count data for each
interaction and <code>.hic</code> file.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="va">matrices</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## &lt;n x m x 3 x 2&gt; JaggedArray:</span></span>
<span><span class="co">## ,,1,1</span></span>
<span><span class="co">## &lt;1 x 3&gt; matrix</span></span>
<span><span class="co">##      [,1] [,2] [,3]</span></span>
<span><span class="co">## [1,]   53   15    5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ,,3,2</span></span>
<span><span class="co">## &lt;3 x 2&gt; matrix</span></span>
<span><span class="co">##      [,1] [,2]</span></span>
<span><span class="co">## [1,]   16    6</span></span>
<span><span class="co">## [2,]    6   17</span></span>
<span><span class="co">## [3,]    3    7</span></span></code></pre>
<p>See the <a href="#interaction_jagged_array_class"><code>InteractionJaggedArray</code>
class</a> section to learn more about accessing and transforming data
from <code>InteractionJaggedArray</code> and <code>JaggedArray</code>
objects.</p>
</div>
</div>
<div class="section level2">
<h2 id="interactionmatrix-class">
<code>InteractionMatrix</code> class
<a id="interaction_matrix_class"></a><a class="anchor" aria-label="anchor" href="#interactionmatrix-class"></a>
</h2>
<p>The <code>InteractionMatrix</code> class extends the
<code>InteractionSet</code> and <code>SummarizedExperiment</code>
classes. Therefore, it also inherits the accessors and methods of these
objects. For example, you can access the original interactions, metadata
about the experiment, row or column metadata, and subset or index slices
of these objects. The following sections highlight some of the most
useful accessors and methods for <code>InteractionMatrix</code> using
this example object:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Load mariner</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ericscottdavis.com/mariner/" class="external-link">mariner</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Use example .hic files from ExperimentHub</span></span>
<span><span class="va">hicFiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://phanstiellab.github.io/plotgardener/reference/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu">marinerData</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/marinerData/man/LEUK_HEK_PJA27_inter_30.hic.html" class="external-link">LEUK_HEK_PJA27_inter_30.hic</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="fu">marinerData</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/marinerData/man/LEUK_HEK_PJA30_inter_30.hic.html" class="external-link">LEUK_HEK_PJA30_inter_30.hic</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">hicFiles</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://phanstiellab.github.io/plotgardener/reference/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hic1"</span>, <span class="st">"hic2"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Make some example interactions</span></span>
<span><span class="va">gi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span></span>
<span>    text<span class="op">=</span><span class="st">"</span></span>
<span><span class="st">    1 51000000 51100000 1 51000000 51100000</span></span>
<span><span class="st">    1 150000000 150100000 1 150000000 150100000</span></span>
<span><span class="st">    2 51000000 51100000 2 51000000 51100000</span></span>
<span><span class="st">    2 150000000 150100000 2 150000000 150100000</span></span>
<span><span class="st">    "</span></span>
<span><span class="op">)</span></span>
<span><span class="va">gi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_ginteractions.html">as_ginteractions</a></span><span class="op">(</span><span class="va">gi</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## InteractionMatrix</span></span>
<span><span class="va">imat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pullHicPixels.html">pullHicPixels</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gi</span>, files<span class="op">=</span><span class="va">hicFiles</span>, binSize<span class="op">=</span><span class="fl">100e3</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="common-accessors">Common accessors<a class="anchor" aria-label="anchor" href="#common-accessors"></a>
</h3>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Show method</span></span>
<span><span class="va">imat</span></span></code></pre></div>
<pre><code><span><span class="co">## class: InteractionMatrix </span></span>
<span><span class="co">## dim: count matrix with 4 interactions and 2 file(s)</span></span>
<span><span class="co">## metadata(3): binSize norm matrix</span></span>
<span><span class="co">## assays(1): counts</span></span>
<span><span class="co">## rownames: NULL</span></span>
<span><span class="co">## rowData names(0):</span></span>
<span><span class="co">## colnames(2): hic1 hic2</span></span>
<span><span class="co">## colData names(2): files fileNames</span></span>
<span><span class="co">## type: GInteractions</span></span>
<span><span class="co">## regions: 4</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Dimensions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">imat</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 4 2</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Metadata about Hi-C extraction</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Annotated-class.html" class="external-link">metadata</a></span><span class="op">(</span><span class="va">imat</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $binSize</span></span>
<span><span class="co">## [1] 1e+05</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $norm</span></span>
<span><span class="co">## [1] "NONE"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $matrix</span></span>
<span><span class="co">## [1] "observed"</span></span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Metadata about interactions</span></span>
<span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">imat</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## DataFrame with 4 rows and 0 columns</span></span></code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Metadata about columns</span></span>
<span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">imat</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## DataFrame with 2 rows and 2 columns</span></span>
<span><span class="co">##                       files         fileNames</span></span>
<span><span class="co">##                 &lt;character&gt;       &lt;character&gt;</span></span>
<span><span class="co">## hic1 /home/runner/.cache/.. 1c6a2e2a0cb1_8147</span></span>
<span><span class="co">## hic2 /home/runner/.cache/.. 1c6a6d746570_8148</span></span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Interactions</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/InteractionSet/man/interaction-accessors.html" class="external-link">interactions</a></span><span class="op">(</span><span class="va">imat</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## GInteractions object with 4 interactions and 0 metadata columns:</span></span>
<span><span class="co">##       seqnames1             ranges1     seqnames2             ranges2</span></span>
<span><span class="co">##           &lt;Rle&gt;           &lt;IRanges&gt;         &lt;Rle&gt;           &lt;IRanges&gt;</span></span>
<span><span class="co">##   [1]         1   51000000-51100000 ---         1   51000000-51100000</span></span>
<span><span class="co">##   [2]         1 150000000-150100000 ---         1 150000000-150100000</span></span>
<span><span class="co">##   [3]         2   51000000-51100000 ---         2   51000000-51100000</span></span>
<span><span class="co">##   [4]         2 150000000-150100000 ---         2 150000000-150100000</span></span>
<span><span class="co">##   -------</span></span>
<span><span class="co">##   regions: 4 ranges and 0 metadata columns</span></span>
<span><span class="co">##   seqinfo: 2 sequences from an unspecified genome; no seqlengths</span></span></code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Count matrices</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="va">imat</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## &lt;4 x 2&gt; DelayedMatrix object of type "double":</span></span>
<span><span class="co">##      hic1 hic2</span></span>
<span><span class="co">## [1,]   53   49</span></span>
<span><span class="co">## [2,]   63   56</span></span>
<span><span class="co">## [3,]   36   16</span></span>
<span><span class="co">## [4,]   43   24</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="indexing-and-subsetting">Indexing and subsetting<a class="anchor" aria-label="anchor" href="#indexing-and-subsetting"></a>
</h3>
<p>You can subset the interactions and files of the object directly
where the first position subsets interactions and the second subsets
files.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">imat</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## &lt;3 x 2&gt; DelayedMatrix object of type "double":</span></span>
<span><span class="co">##      hic1 hic2</span></span>
<span><span class="co">## [1,]   53   49</span></span>
<span><span class="co">## [2,]   63   56</span></span>
<span><span class="co">## [3,]   36   16</span></span></code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">imat</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">1</span><span class="op">]</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## &lt;3 x 2&gt; DelayedMatrix object of type "double":</span></span>
<span><span class="co">##      hic1 hic2</span></span>
<span><span class="co">## [1,]   36   16</span></span>
<span><span class="co">## [2,]   63   56</span></span>
<span><span class="co">## [3,]   53   49</span></span></code></pre>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">imat</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## &lt;4 x 1&gt; DelayedMatrix object of type "double":</span></span>
<span><span class="co">##      hic2</span></span>
<span><span class="co">## [1,]   49</span></span>
<span><span class="co">## [2,]   56</span></span>
<span><span class="co">## [3,]   16</span></span>
<span><span class="co">## [4,]   24</span></span></code></pre>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">imat</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## &lt;1 x 1&gt; DelayedMatrix object of type "double":</span></span>
<span><span class="co">##      hic1</span></span>
<span><span class="co">## [1,]   53</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="concatenating">Concatenating<a class="anchor" aria-label="anchor" href="#concatenating"></a>
</h3>
<p>Use the <code><a href="https://rdrr.io/pkg/BiocGenerics/man/cbind.html" class="external-link">rbind()</a></code> or <code><a href="https://rdrr.io/pkg/BiocGenerics/man/cbind.html" class="external-link">cbind()</a></code> functions to
combine interactions row-wise or column-wise, respectively.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">imat</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">imat</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## class: InteractionMatrix </span></span>
<span><span class="co">## dim: count matrix with 4 interactions and 2 file(s)</span></span>
<span><span class="co">## metadata(3): binSize norm matrix</span></span>
<span><span class="co">## assays(1): counts</span></span>
<span><span class="co">## rownames: NULL</span></span>
<span><span class="co">## rowData names(0):</span></span>
<span><span class="co">## colnames(2): hic1 hic2</span></span>
<span><span class="co">## colData names(2): files fileNames</span></span>
<span><span class="co">## type: GInteractions</span></span>
<span><span class="co">## regions: 4</span></span></code></pre>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">imat</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="op">]</span>, <span class="va">imat</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span>,<span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## class: InteractionMatrix </span></span>
<span><span class="co">## dim: count matrix with 4 interactions and 2 file(s)</span></span>
<span><span class="co">## metadata(3): binSize norm matrix</span></span>
<span><span class="co">## assays(1): counts</span></span>
<span><span class="co">## rownames: NULL</span></span>
<span><span class="co">## rowData names(0):</span></span>
<span><span class="co">## colnames(2): hic1 hic2</span></span>
<span><span class="co">## colData names(2): files fileNames</span></span>
<span><span class="co">## type: GInteractions</span></span>
<span><span class="co">## regions: 4</span></span></code></pre>
<p>Note that the column metadata must be the same when using
<code>rbind</code> and the row interactions must be the same when using
<code>cbind</code>.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">imat</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">imat</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;"> in `rbind()`:</span></span></span>
<span><span class="co">## <span style="color: #BBBB00;">!</span> Can't rbind InteractionMatrix objects with different colData.</span></span></code></pre>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">imat</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">imat</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;"> in `cbind()`:</span></span></span>
<span><span class="co">## <span style="color: #BBBB00;">!</span> interactions must be identical in 'cbind'</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="overlapping">Overlapping<a class="anchor" aria-label="anchor" href="#overlapping"></a>
</h3>
<p>Methods for <code><a href="../reference/InteractionJaggedArray-overlaps.html">subsetByOverlaps()</a></code>,
<code><a href="../reference/InteractionJaggedArray-overlaps.html">findOverlaps()</a></code>, <code><a href="../reference/InteractionJaggedArray-overlaps.html">countOverlaps()</a></code>, and
<code><a href="../reference/InteractionJaggedArray-overlaps.html">overlapsAny()</a></code> are inherited from the
<code>InteractionSet</code> and <code>IRanges</code> packages. See the
documentation and vignettes of these packages for usage and behavior of
these functions.</p>
</div>
</div>
<div class="section level2">
<h2 id="interactionarray-class">
<code>InteractionArray</code> class
<a id="interaction_array_class"></a><a class="anchor" aria-label="anchor" href="#interactionarray-class"></a>
</h2>
<p>The <code>InteractionArray</code> class extends the
<code>InteractionSet</code> and <code>SummarizedExperiment</code>
classes. Therefore, it also inherits the accessors and methods of these
objects. For example, you can access the original interactions, metadata
about the experiment, row or column metadata, and subset or index slices
of these objects. Unlike the the <code>InteractionMatrix</code> class
which returns an “interaction-by-Hi-C” matrix, the
<code>InteractionArray</code> class returns count matrices for each
interaction and <code>.hic</code> file. This results in a 4-dimensional
array, where the first two dimensions are the rows and columns of the
count matrices, the third dimension is the supplied interactions, and
the fourth dimension is the supplied <code>.hic</code> files. This is
stored as a <code>DelayedArray</code> which is accessible via the
<code><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts()</a></code> accessor. The following sections highlight some of
the most useful accessors and methods for <code>InteractionMatrix</code>
using this example object:</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Load mariner</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ericscottdavis.com/mariner/" class="external-link">mariner</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Use example .hic files from ExperimentHub</span></span>
<span><span class="va">hicFiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://phanstiellab.github.io/plotgardener/reference/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu">marinerData</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/marinerData/man/LEUK_HEK_PJA27_inter_30.hic.html" class="external-link">LEUK_HEK_PJA27_inter_30.hic</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="fu">marinerData</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/marinerData/man/LEUK_HEK_PJA30_inter_30.hic.html" class="external-link">LEUK_HEK_PJA30_inter_30.hic</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">hicFiles</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://phanstiellab.github.io/plotgardener/reference/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hic1"</span>, <span class="st">"hic2"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Create 500x500 Kb regions</span></span>
<span><span class="va">regions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span></span>
<span>    text<span class="op">=</span><span class="st">"</span></span>
<span><span class="st">    1 51000000 51500000 1 51000000 51500000</span></span>
<span><span class="st">    1 150000000 150500000 1 150000000 150500000</span></span>
<span><span class="st">    2 51000000 51500000 2 51000000 51500000</span></span>
<span><span class="st">    2 150000000 150500000 2 150000000 150500000</span></span>
<span><span class="st">    "</span></span>
<span><span class="op">)</span></span>
<span><span class="va">regions</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_ginteractions.html">as_ginteractions</a></span><span class="op">(</span><span class="va">regions</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## InteractionArray</span></span>
<span><span class="va">ia</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pullHicMatrices.html">pullHicMatrices</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">regions</span>, files<span class="op">=</span><span class="va">hicFiles</span>, binSize<span class="op">=</span><span class="fl">100e3</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="common-accessors-1">Common accessors<a class="anchor" aria-label="anchor" href="#common-accessors-1"></a>
</h3>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Show method</span></span>
<span><span class="va">ia</span></span></code></pre></div>
<pre><code><span><span class="co">## class: InteractionArray </span></span>
<span><span class="co">## dim: 4 interaction(s), 2 file(s), 5x5 count matrix(es)</span></span>
<span><span class="co">## metadata(3): binSize norm matrix</span></span>
<span><span class="co">## assays(3): counts rownames colnames</span></span>
<span><span class="co">## rownames: NULL</span></span>
<span><span class="co">## rowData names(0):</span></span>
<span><span class="co">## colnames(2): hic1 hic2</span></span>
<span><span class="co">## colData names(2): files fileNames</span></span>
<span><span class="co">## type: GInteractions</span></span>
<span><span class="co">## regions: 4</span></span></code></pre>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Dimensions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">ia</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 4 2</span></span></code></pre>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Metadata about Hi-C extraction</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Annotated-class.html" class="external-link">metadata</a></span><span class="op">(</span><span class="va">ia</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $binSize</span></span>
<span><span class="co">## [1] 1e+05</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $norm</span></span>
<span><span class="co">## [1] "NONE"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $matrix</span></span>
<span><span class="co">## [1] "observed"</span></span></code></pre>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Metadata about interactions</span></span>
<span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">ia</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## DataFrame with 4 rows and 0 columns</span></span></code></pre>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Metadata about columns</span></span>
<span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">ia</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## DataFrame with 2 rows and 2 columns</span></span>
<span><span class="co">##                       files         fileNames</span></span>
<span><span class="co">##                 &lt;character&gt;       &lt;character&gt;</span></span>
<span><span class="co">## hic1 /home/runner/.cache/.. 1c6a2e2a0cb1_8147</span></span>
<span><span class="co">## hic2 /home/runner/.cache/.. 1c6a6d746570_8148</span></span></code></pre>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Interactions</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/InteractionSet/man/interaction-accessors.html" class="external-link">interactions</a></span><span class="op">(</span><span class="va">ia</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## GInteractions object with 4 interactions and 0 metadata columns:</span></span>
<span><span class="co">##       seqnames1             ranges1     seqnames2             ranges2</span></span>
<span><span class="co">##           &lt;Rle&gt;           &lt;IRanges&gt;         &lt;Rle&gt;           &lt;IRanges&gt;</span></span>
<span><span class="co">##   [1]         1   51000000-51500000 ---         1   51000000-51500000</span></span>
<span><span class="co">##   [2]         1 150000000-150500000 ---         1 150000000-150500000</span></span>
<span><span class="co">##   [3]         2   51000000-51500000 ---         2   51000000-51500000</span></span>
<span><span class="co">##   [4]         2 150000000-150500000 ---         2 150000000-150500000</span></span>
<span><span class="co">##   -------</span></span>
<span><span class="co">##   regions: 4 ranges and 0 metadata columns</span></span>
<span><span class="co">##   seqinfo: 2 sequences from an unspecified genome; no seqlengths</span></span></code></pre>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Count matrices</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="va">ia</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## &lt;5 x 5 x 4 x 2&gt; DelayedArray object of type "double":</span></span>
<span><span class="co">## ,,1,hic1</span></span>
<span><span class="co">##      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">## [1,]   53   15    5    1    4</span></span>
<span><span class="co">## [2,]   15   68   19    8    5</span></span>
<span><span class="co">## [3,]    5   19   69   12    2</span></span>
<span><span class="co">## [4,]    1    8   12   48   13</span></span>
<span><span class="co">## [5,]    4    5    2   13   48</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ,,4,hic2</span></span>
<span><span class="co">##      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">## [1,]   24   11    3    7    4</span></span>
<span><span class="co">## [2,]   11   26    2    6    5</span></span>
<span><span class="co">## [3,]    3    2   41   17    4</span></span>
<span><span class="co">## [4,]    7    6   17   42   14</span></span>
<span><span class="co">## [5,]    4    5    4   14   44</span></span></code></pre>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Counts with start bins for anchor1 and 2</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="va">ia</span>, showDimnames<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## &lt;5 x 5 x 4 x 2&gt; DelayedArray object of type "double":</span></span>
<span><span class="co">## ,,1,hic1</span></span>
<span><span class="co">##          51000000 51100000 51200000 51300000 51400000</span></span>
<span><span class="co">## 51000000       53       15        5        1        4</span></span>
<span><span class="co">## 51100000       15       68       19        8        5</span></span>
<span><span class="co">## 51200000        5       19       69       12        2</span></span>
<span><span class="co">## 51300000        1        8       12       48       13</span></span>
<span><span class="co">## 51400000        4        5        2       13       48</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ,,4,hic2</span></span>
<span><span class="co">##           150000000 150100000 150200000 150300000 150400000</span></span>
<span><span class="co">## 150000000        24        11         3         7         4</span></span>
<span><span class="co">## 150100000        11        26         2         6         5</span></span>
<span><span class="co">## 150200000         3         2        41        17         4</span></span>
<span><span class="co">## 150300000         7         6        17        42        14</span></span>
<span><span class="co">## 150400000         4         5         4        14        44</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="indexing-and-subsetting-1">Indexing and subsetting<a class="anchor" aria-label="anchor" href="#indexing-and-subsetting-1"></a>
</h3>
<p>You can subset the interactions and files of the object directly
where the first position subsets interactions and the second subsets
files.</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ia</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## &lt;5 x 5 x 3 x 2&gt; DelayedArray object of type "double":</span></span>
<span><span class="co">## ,,1,hic1</span></span>
<span><span class="co">##      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">## [1,]   53   15    5    1    4</span></span>
<span><span class="co">## [2,]   15   68   19    8    5</span></span>
<span><span class="co">## [3,]    5   19   69   12    2</span></span>
<span><span class="co">## [4,]    1    8   12   48   13</span></span>
<span><span class="co">## [5,]    4    5    2   13   48</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ,,3,hic2</span></span>
<span><span class="co">##      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">## [1,]   16    6    3    2    4</span></span>
<span><span class="co">## [2,]    6   17    7    2    0</span></span>
<span><span class="co">## [3,]    3    7   23    6    0</span></span>
<span><span class="co">## [4,]    2    2    6   23    2</span></span>
<span><span class="co">## [5,]    4    0    0    2   24</span></span></code></pre>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ia</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">1</span><span class="op">]</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## &lt;5 x 5 x 3 x 2&gt; DelayedArray object of type "double":</span></span>
<span><span class="co">## ,,1,hic1</span></span>
<span><span class="co">##      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">## [1,]   36    5    5    2    4</span></span>
<span><span class="co">## [2,]    5   30   13    4    1</span></span>
<span><span class="co">## [3,]    5   13   22    6    6</span></span>
<span><span class="co">## [4,]    2    4    6   30    4</span></span>
<span><span class="co">## [5,]    4    1    6    4   21</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ,,3,hic2</span></span>
<span><span class="co">##      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">## [1,]   49   27    4    5    3</span></span>
<span><span class="co">## [2,]   27   49   13    2    6</span></span>
<span><span class="co">## [3,]    4   13   56    7    8</span></span>
<span><span class="co">## [4,]    5    2    7   48   10</span></span>
<span><span class="co">## [5,]    3    6    8   10   47</span></span></code></pre>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ia</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## &lt;5 x 5 x 4 x 1&gt; DelayedArray object of type "double":</span></span>
<span><span class="co">## ,,1,hic2</span></span>
<span><span class="co">##      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">## [1,]   49   27    4    5    3</span></span>
<span><span class="co">## [2,]   27   49   13    2    6</span></span>
<span><span class="co">## [3,]    4   13   56    7    8</span></span>
<span><span class="co">## [4,]    5    2    7   48   10</span></span>
<span><span class="co">## [5,]    3    6    8   10   47</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ,,4,hic2</span></span>
<span><span class="co">##      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">## [1,]   24   11    3    7    4</span></span>
<span><span class="co">## [2,]   11   26    2    6    5</span></span>
<span><span class="co">## [3,]    3    2   41   17    4</span></span>
<span><span class="co">## [4,]    7    6   17   42   14</span></span>
<span><span class="co">## [5,]    4    5    4   14   44</span></span></code></pre>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ia</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## &lt;5 x 5 x 1 x 1&gt; DelayedArray object of type "double":</span></span>
<span><span class="co">## ,,1,hic1</span></span>
<span><span class="co">##      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">## [1,]   53   15    5    1    4</span></span>
<span><span class="co">## [2,]   15   68   19    8    5</span></span>
<span><span class="co">## [3,]    5   19   69   12    2</span></span>
<span><span class="co">## [4,]    1    8   12   48   13</span></span>
<span><span class="co">## [5,]    4    5    2   13   48</span></span></code></pre>
<p>Subsetting and indexing can also be done on the
<code>DelayedArray</code> object accessed with <code><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts()</a></code>.
For example, the following code shows how you could access the top left
corner of the count matrix of the first interaction and
<code>.hic</code> file.</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="va">ia</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## &lt;3 x 3&gt; DelayedMatrix object of type "double":</span></span>
<span><span class="co">##      [,1] [,2] [,3]</span></span>
<span><span class="co">## [1,]   53   15    5</span></span>
<span><span class="co">## [2,]   15   68   19</span></span>
<span><span class="co">## [3,]    5   19   69</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="concatenating-1">Concatenating<a class="anchor" aria-label="anchor" href="#concatenating-1"></a>
</h3>
<p>Use the <code><a href="https://rdrr.io/pkg/BiocGenerics/man/cbind.html" class="external-link">rbind()</a></code> or <code><a href="https://rdrr.io/pkg/BiocGenerics/man/cbind.html" class="external-link">cbind()</a></code> functions to
combine interactions row-wise or column-wise, respectively.</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">ia</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">ia</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## class: InteractionArray </span></span>
<span><span class="co">## dim: 4 interaction(s), 2 file(s), 5x5 count matrix(es)</span></span>
<span><span class="co">## metadata(3): binSize norm matrix</span></span>
<span><span class="co">## assays(3): counts rownames colnames</span></span>
<span><span class="co">## rownames: NULL</span></span>
<span><span class="co">## rowData names(0):</span></span>
<span><span class="co">## colnames(2): hic1 hic2</span></span>
<span><span class="co">## colData names(2): files fileNames</span></span>
<span><span class="co">## type: GInteractions</span></span>
<span><span class="co">## regions: 4</span></span></code></pre>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">ia</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="op">]</span>, <span class="va">ia</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span>,<span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## class: InteractionArray </span></span>
<span><span class="co">## dim: 4 interaction(s), 2 file(s), 5x5 count matrix(es)</span></span>
<span><span class="co">## metadata(3): binSize norm matrix</span></span>
<span><span class="co">## assays(3): counts rownames colnames</span></span>
<span><span class="co">## rownames: NULL</span></span>
<span><span class="co">## rowData names(0):</span></span>
<span><span class="co">## colnames(2): hic1 hic2</span></span>
<span><span class="co">## colData names(2): files fileNames</span></span>
<span><span class="co">## type: GInteractions</span></span>
<span><span class="co">## regions: 4</span></span></code></pre>
<p>Note that the column metadata must be the same when using
<code>rbind</code> and the row interactions must be the same when using
<code>cbind</code>.</p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">ia</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">ia</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;"> in `rbind()`:</span></span></span>
<span><span class="co">## <span style="color: #BBBB00;">!</span> Can't rbind InteractionArray objects with different colData.</span></span></code></pre>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">ia</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">ia</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;"> in `cbind()`:</span></span></span>
<span><span class="co">## <span style="color: #BBBB00;">!</span> interactions must be identical in 'cbind'</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="overlapping-1">Overlapping<a class="anchor" aria-label="anchor" href="#overlapping-1"></a>
</h3>
<p>Methods for <code><a href="../reference/InteractionJaggedArray-overlaps.html">subsetByOverlaps()</a></code>,
<code><a href="../reference/InteractionJaggedArray-overlaps.html">findOverlaps()</a></code>, <code><a href="../reference/InteractionJaggedArray-overlaps.html">countOverlaps()</a></code>, and
<code><a href="../reference/InteractionJaggedArray-overlaps.html">overlapsAny()</a></code> are inherited from the
<code>InteractionSet</code> and <code>IRanges</code> packages. See the
documentation and vignettes of these packages for usage and behavior of
these functions.</p>
</div>
</div>
<div class="section level2">
<h2 id="interactionjaggedarray-class">
<code>InteractionJaggedArray</code> class
<a id="interaction_jagged_array_class"></a><a class="anchor" aria-label="anchor" href="#interactionjaggedarray-class"></a>
</h2>
<p>The <code>InteractionJaggedArray</code> class is a new class designed
for holding irregularly sized count matrices, also known as “ragged” or
“jagged” arrays along with other important information about the
extracted Hi-C data. The count matrices are managed by the
<code>JaggedArray</code> class which is analogous to the
<code>DelayedArray</code> class. <code>JaggedArray</code> data is stored
on-disk in an HDF5 file, and subsetting/indexing operations are delayed
similarly to <code>DelayedArray</code>. Continue reading to learn about
how to use <code>InteractionJaggedArray</code> and
<code>JaggedArray</code> objects, and how to convert them to
<code>InteractionArray</code> or <code>DelayedArray</code> objects with
the <code><a href="../reference/regularize.html">regularize()</a></code> function for downstream analysis.</p>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Load mariner</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ericscottdavis.com/mariner/" class="external-link">mariner</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Use example .hic files from ExperimentHub</span></span>
<span><span class="va">hicFiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://phanstiellab.github.io/plotgardener/reference/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu">marinerData</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/marinerData/man/LEUK_HEK_PJA27_inter_30.hic.html" class="external-link">LEUK_HEK_PJA27_inter_30.hic</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="fu">marinerData</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/marinerData/man/LEUK_HEK_PJA30_inter_30.hic.html" class="external-link">LEUK_HEK_PJA30_inter_30.hic</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">hicFiles</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://phanstiellab.github.io/plotgardener/reference/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hic1"</span>, <span class="st">"hic2"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Create regions of different dimensions</span></span>
<span><span class="va">regions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span></span>
<span>    text<span class="op">=</span><span class="st">"</span></span>
<span><span class="st">    1 51000000 51100000 1 51000000 51300000</span></span>
<span><span class="st">    1 150000000 150300000 1 150000000 150300000</span></span>
<span><span class="st">    2 51000000 51300000 2 51000000 51200000</span></span>
<span><span class="st">    "</span></span>
<span><span class="op">)</span></span>
<span><span class="va">regions</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_ginteractions.html">as_ginteractions</a></span><span class="op">(</span><span class="va">regions</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## InteractionJaggedArray</span></span>
<span><span class="va">ija</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pullHicMatrices.html">pullHicMatrices</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">regions</span>, files<span class="op">=</span><span class="va">hicFiles</span>, binSize<span class="op">=</span><span class="fl">100e3</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="common-accessors-2">Common accessors<a class="anchor" aria-label="anchor" href="#common-accessors-2"></a>
</h3>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Show method</span></span>
<span><span class="va">ija</span></span></code></pre></div>
<pre><code><span><span class="co">## class: InteractionJaggedArray</span></span>
<span><span class="co">## dim: 3 interaction(s), 2 file(s), variable count matrix(es)</span></span>
<span><span class="co">## metadata(3): binSize, norm, matrix</span></span>
<span><span class="co">## colData: hic1, hic2</span></span>
<span><span class="co">## colData names(2): files, fileNames</span></span>
<span><span class="co">## HDF5: /tmp/RtmpdicOqR/file20c24eeaf134.h5</span></span></code></pre>
<p>The variable dimensions of the jagged arrays can be accessed with the
<code><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim()</a></code> function:</p>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Dimensions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">ija</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $interactions</span></span>
<span><span class="co">## [1] 3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $files</span></span>
<span><span class="co">## [1] 2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $rows</span></span>
<span><span class="co">## [1] 1 3 3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $cols</span></span>
<span><span class="co">## [1] 3 3 2</span></span></code></pre>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Metadata about Hi-C extraction</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Annotated-class.html" class="external-link">metadata</a></span><span class="op">(</span><span class="va">ija</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $binSize</span></span>
<span><span class="co">## [1] 1e+05</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $norm</span></span>
<span><span class="co">## [1] "NONE"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $matrix</span></span>
<span><span class="co">## [1] "observed"</span></span></code></pre>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Metadata about columns</span></span>
<span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">ija</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## DataFrame with 2 rows and 2 columns</span></span>
<span><span class="co">##                       files         fileNames</span></span>
<span><span class="co">##                 &lt;character&gt;       &lt;character&gt;</span></span>
<span><span class="co">## hic1 /home/runner/.cache/.. 1c6a2e2a0cb1_8147</span></span>
<span><span class="co">## hic2 /home/runner/.cache/.. 1c6a6d746570_8148</span></span></code></pre>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Access HDF5 filepath</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/path.html" class="external-link">path</a></span><span class="op">(</span><span class="va">ija</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "/tmp/RtmpdicOqR/file20c24eeaf134.h5"</span></span></code></pre>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Interactions</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/InteractionSet/man/interaction-accessors.html" class="external-link">interactions</a></span><span class="op">(</span><span class="va">ija</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## GInteractions object with 3 interactions and 0 metadata columns:</span></span>
<span><span class="co">##       seqnames1             ranges1     seqnames2             ranges2</span></span>
<span><span class="co">##           &lt;Rle&gt;           &lt;IRanges&gt;         &lt;Rle&gt;           &lt;IRanges&gt;</span></span>
<span><span class="co">##   [1]         1   51000000-51100000 ---         1   51000000-51300000</span></span>
<span><span class="co">##   [2]         1 150000000-150300000 ---         1 150000000-150300000</span></span>
<span><span class="co">##   [3]         2   51000000-51300000 ---         2   51000000-51200000</span></span>
<span><span class="co">##   -------</span></span>
<span><span class="co">##   regions: 5 ranges and 0 metadata columns</span></span>
<span><span class="co">##   seqinfo: 2 sequences from an unspecified genome; no seqlengths</span></span></code></pre>
<p>The <code><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts()</a></code> function returns a
<code>JaggedArray</code></p>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Count matrices as JaggedArray</span></span>
<span><span class="va">ja</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="va">ija</span><span class="op">)</span></span>
<span><span class="va">ja</span></span></code></pre></div>
<pre><code><span><span class="co">## &lt;n x m x 3 x 2&gt; JaggedArray:</span></span>
<span><span class="co">## ,,1,1</span></span>
<span><span class="co">## &lt;1 x 3&gt; matrix</span></span>
<span><span class="co">##      [,1] [,2] [,3]</span></span>
<span><span class="co">## [1,]   53   15    5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ,,3,2</span></span>
<span><span class="co">## &lt;3 x 2&gt; matrix</span></span>
<span><span class="co">##      [,1] [,2]</span></span>
<span><span class="co">## [1,]   16    6</span></span>
<span><span class="co">## [2,]    6   17</span></span>
<span><span class="co">## [3,]    3    7</span></span></code></pre>
<p>This can be converted to a nested R list with the
<code><a href="https://rdrr.io/pkg/BiocGenerics/man/as.list.html" class="external-link">as.list()</a></code> function, where the outer level refers to the
<code>.hic</code> file and the inner level contains a matrix for each
interaction.</p>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">ja</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [[1]]</span></span>
<span><span class="co">## [[1]][[1]]</span></span>
<span><span class="co">##      [,1] [,2] [,3]</span></span>
<span><span class="co">## [1,]   53   15    5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[1]][[2]]</span></span>
<span><span class="co">##      [,1] [,2] [,3]</span></span>
<span><span class="co">## [1,]   63   25   15</span></span>
<span><span class="co">## [2,]   25   68   28</span></span>
<span><span class="co">## [3,]   15   28   87</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[1]][[3]]</span></span>
<span><span class="co">##      [,1] [,2]</span></span>
<span><span class="co">## [1,]   36    5</span></span>
<span><span class="co">## [2,]    5   30</span></span>
<span><span class="co">## [3,]    5   13</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[2]]</span></span>
<span><span class="co">## [[2]][[1]]</span></span>
<span><span class="co">##      [,1] [,2] [,3]</span></span>
<span><span class="co">## [1,]   49   27    4</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[2]][[2]]</span></span>
<span><span class="co">##      [,1] [,2] [,3]</span></span>
<span><span class="co">## [1,]   56   26    8</span></span>
<span><span class="co">## [2,]   26   60   14</span></span>
<span><span class="co">## [3,]    8   14   89</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[2]][[3]]</span></span>
<span><span class="co">##      [,1] [,2]</span></span>
<span><span class="co">## [1,]   16    6</span></span>
<span><span class="co">## [2,]    6   17</span></span>
<span><span class="co">## [3,]    3    7</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="indexing-and-subsetting-2">Indexing and subsetting<a class="anchor" aria-label="anchor" href="#indexing-and-subsetting-2"></a>
</h3>
<p>You can subset the interactions and files of the object directly
where the first position subsets interactions and the second subsets
files.</p>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ija</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## &lt;n x m x 2 x 2&gt; JaggedArray:</span></span>
<span><span class="co">## ,,1,1</span></span>
<span><span class="co">## &lt;1 x 3&gt; matrix</span></span>
<span><span class="co">##      [,1] [,2] [,3]</span></span>
<span><span class="co">## [1,]   53   15    5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ,,2,2</span></span>
<span><span class="co">## &lt;3 x 3&gt; matrix</span></span>
<span><span class="co">##      [,1] [,2] [,3]</span></span>
<span><span class="co">## [1,]   56   26    8</span></span>
<span><span class="co">## [2,]   26   60   14</span></span>
<span><span class="co">## [3,]    8   14   89</span></span></code></pre>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ija</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">1</span><span class="op">]</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## &lt;n x m x 2 x 2&gt; JaggedArray:</span></span>
<span><span class="co">## ,,1,1</span></span>
<span><span class="co">## &lt;3 x 3&gt; matrix</span></span>
<span><span class="co">##      [,1] [,2] [,3]</span></span>
<span><span class="co">## [1,]   63   25   15</span></span>
<span><span class="co">## [2,]   25   68   28</span></span>
<span><span class="co">## [3,]   15   28   87</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ,,2,2</span></span>
<span><span class="co">## &lt;1 x 3&gt; matrix</span></span>
<span><span class="co">##      [,1] [,2] [,3]</span></span>
<span><span class="co">## [1,]   49   27    4</span></span></code></pre>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ija</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## &lt;n x m x 3 x 1&gt; JaggedArray:</span></span>
<span><span class="co">## ,,1,1</span></span>
<span><span class="co">## &lt;1 x 3&gt; matrix</span></span>
<span><span class="co">##      [,1] [,2] [,3]</span></span>
<span><span class="co">## [1,]   49   27    4</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ,,3,1</span></span>
<span><span class="co">## &lt;3 x 2&gt; matrix</span></span>
<span><span class="co">##      [,1] [,2]</span></span>
<span><span class="co">## [1,]   16    6</span></span>
<span><span class="co">## [2,]    6   17</span></span>
<span><span class="co">## [3,]    3    7</span></span></code></pre>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ija</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## &lt;1 x 3 x 1 x 1&gt; DelayedArray object of type "double":</span></span>
<span><span class="co">## ,,1,hic1</span></span>
<span><span class="co">##      [,1] [,2] [,3]</span></span>
<span><span class="co">## [1,]   53   15    5</span></span></code></pre>
<p>Notice that when indexing results in subset of data with the same
dimensions it is automatically coerced to an
<code>InteractionArray</code> or <code>DelayedArray</code>.</p>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ija</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "InteractionArray"</span></span>
<span><span class="co">## attr(,"package")</span></span>
<span><span class="co">## [1] "mariner"</span></span></code></pre>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ija</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "DelayedArray"</span></span>
<span><span class="co">## attr(,"package")</span></span>
<span><span class="co">## [1] "DelayedArray"</span></span></code></pre>
<p>You can also subset and index on the <code>JaggedArray</code> object
by selecting the desired interactions(s) in the third dimension and
<code>.hic</code> file(s) in the fourth dimension. Since the first two
dimensions are variable, subsetting/indexing these is not supported.</p>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ja</span><span class="op">[</span>,,<span class="fl">3</span>,<span class="fl">2</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## &lt;3 x 2 x 1 x 1&gt; DelayedArray object of type "double":</span></span>
<span><span class="co">## ,,1,1</span></span>
<span><span class="co">##      [,1] [,2]</span></span>
<span><span class="co">## [1,]   16    6</span></span>
<span><span class="co">## [2,]    6   17</span></span>
<span><span class="co">## [3,]    3    7</span></span></code></pre>
<p>If the selection results in a <code>DelayedArray</code> then normal
indexing rules apply:</p>
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ja</span><span class="op">[</span>,,<span class="fl">3</span>,<span class="fl">2</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 16  6</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="concatenating-2">Concatenating<a class="anchor" aria-label="anchor" href="#concatenating-2"></a>
</h3>
<p>Concatenating <code>InteractionJaggedArray</code> and
<code>JaggedArray</code> objects is not currently supported. If you need
this functionality please post an <a href="https://github.com/EricSDavis/mariner/issues" class="external-link">issue</a> to the
mariner repository or (even better) submit a pull request with an
implementation.</p>
</div>
<div class="section level3">
<h3 id="overlapping-2">Overlapping<a class="anchor" aria-label="anchor" href="#overlapping-2"></a>
</h3>
<p>Methods for <code><a href="../reference/InteractionJaggedArray-overlaps.html">subsetByOverlaps()</a></code>,
<code><a href="../reference/InteractionJaggedArray-overlaps.html">findOverlaps()</a></code>, <code><a href="../reference/InteractionJaggedArray-overlaps.html">countOverlaps()</a></code>, and
<code><a href="../reference/InteractionJaggedArray-overlaps.html">overlapsAny()</a></code> are inherited from the
<code>InteractionSet</code> and <code>IRanges</code> packages. See the
documentation and vignettes of these packages for usage and behavior of
these functions.</p>
</div>
<div class="section level3">
<h3 id="converting-to-regular-arrays">Converting to regular arrays<a class="anchor" aria-label="anchor" href="#converting-to-regular-arrays"></a>
</h3>
<p>For downstream aggregation and visualization, it is helpful to
convert irregular/jagged arrays to regular arrays. The
<code><a href="../reference/regularize.html">regularize()</a></code> function stretches and (optionally) scales the
count matrices into the desired rectangular (or square) matrices with
dimensions supplied to <code>ndim</code>. The function works on both
<code>InteractionJaggedArray</code> and <code>JaggedArray</code>
objects.</p>
<div class="sourceCode" id="cb126"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/regularize.html">regularize</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">ija</span>, ndim<span class="op">=</span><span class="fu"><a href="https://phanstiellab.github.io/plotgardener/reference/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## / Reading and realizing block 1/3 of file 1/2 ... OK</span></span>
<span><span class="co">## \ Processing it ... Loading required namespace: fields</span></span>
<span><span class="co">## OK</span></span>
<span><span class="co">## / Reading and realizing block 2/3 of file 1/2 ... OK</span></span>
<span><span class="co">## \ Processing it ... OK</span></span>
<span><span class="co">## / Reading and realizing block 3/3 of file 1/2 ... OK</span></span>
<span><span class="co">## \ Processing it ... OK</span></span>
<span><span class="co">## / Reading and realizing block 1/3 of file 2/2 ... OK</span></span>
<span><span class="co">## \ Processing it ... OK</span></span>
<span><span class="co">## / Reading and realizing block 2/3 of file 2/2 ... OK</span></span>
<span><span class="co">## \ Processing it ... OK</span></span>
<span><span class="co">## / Reading and realizing block 3/3 of file 2/2 ... OK</span></span>
<span><span class="co">## \ Processing it ... OK</span></span></code></pre>
<pre><code><span><span class="co">## &lt;3 x 3 x 3 x 2&gt; DelayedArray object of type "double":</span></span>
<span><span class="co">## ,,1,hic1</span></span>
<span><span class="co">##            [,1]       [,2]       [,3]</span></span>
<span><span class="co">## [1,] 0.24200913 0.06849315 0.02283105</span></span>
<span><span class="co">## [2,] 0.24200913 0.06849315 0.02283105</span></span>
<span><span class="co">## [3,] 0.24200913 0.06849315 0.02283105</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ,,2,hic1</span></span>
<span><span class="co">##            [,1]       [,2]       [,3]</span></span>
<span><span class="co">## [1,] 0.17796610 0.07062147 0.04237288</span></span>
<span><span class="co">## [2,] 0.07062147 0.19209040 0.07909605</span></span>
<span><span class="co">## [3,] 0.04237288 0.07909605 0.24576271</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ,,3,hic1</span></span>
<span><span class="co">##            [,1]       [,2]       [,3]</span></span>
<span><span class="co">## [1,] 0.25531915 0.14539007 0.03546099</span></span>
<span><span class="co">## [2,] 0.03546099 0.12411348 0.21276596</span></span>
<span><span class="co">## [3,] 0.03546099 0.06382979 0.09219858</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ,,1,hic2</span></span>
<span><span class="co">##            [,1]       [,2]       [,3]</span></span>
<span><span class="co">## [1,] 0.20416667 0.11250000 0.01666667</span></span>
<span><span class="co">## [2,] 0.20416667 0.11250000 0.01666667</span></span>
<span><span class="co">## [3,] 0.20416667 0.11250000 0.01666667</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ,,2,hic2</span></span>
<span><span class="co">##            [,1]       [,2]       [,3]</span></span>
<span><span class="co">## [1,] 0.18604651 0.08637874 0.02657807</span></span>
<span><span class="co">## [2,] 0.08637874 0.19933555 0.04651163</span></span>
<span><span class="co">## [3,] 0.02657807 0.04651163 0.29568106</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ,,3,hic2</span></span>
<span><span class="co">##            [,1]       [,2]       [,3]</span></span>
<span><span class="co">## [1,] 0.19393939 0.13333333 0.07272727</span></span>
<span><span class="co">## [2,] 0.07272727 0.13939394 0.20606061</span></span>
<span><span class="co">## [3,] 0.03636364 0.06060606 0.08484848</span></span></code></pre>
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/regularize.html">regularize</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">ja</span>, ndim<span class="op">=</span><span class="fu"><a href="https://phanstiellab.github.io/plotgardener/reference/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## / Reading and realizing block 1/3 of file 1/2 ... OK</span></span>
<span><span class="co">## \ Processing it ... OK</span></span>
<span><span class="co">## / Reading and realizing block 2/3 of file 1/2 ... OK</span></span>
<span><span class="co">## \ Processing it ... OK</span></span>
<span><span class="co">## / Reading and realizing block 3/3 of file 1/2 ... OK</span></span>
<span><span class="co">## \ Processing it ... OK</span></span>
<span><span class="co">## / Reading and realizing block 1/3 of file 2/2 ... OK</span></span>
<span><span class="co">## \ Processing it ... OK</span></span>
<span><span class="co">## / Reading and realizing block 2/3 of file 2/2 ... OK</span></span>
<span><span class="co">## \ Processing it ... OK</span></span>
<span><span class="co">## / Reading and realizing block 3/3 of file 2/2 ... OK</span></span>
<span><span class="co">## \ Processing it ... OK</span></span></code></pre>
<pre><code><span><span class="co">## &lt;3 x 3 x 3 x 2&gt; HDF5Array object of type "double":</span></span>
<span><span class="co">## ,,1,1</span></span>
<span><span class="co">##            [,1]       [,2]       [,3]</span></span>
<span><span class="co">## [1,] 0.24200913 0.06849315 0.02283105</span></span>
<span><span class="co">## [2,] 0.24200913 0.06849315 0.02283105</span></span>
<span><span class="co">## [3,] 0.24200913 0.06849315 0.02283105</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ,,2,1</span></span>
<span><span class="co">##            [,1]       [,2]       [,3]</span></span>
<span><span class="co">## [1,] 0.17796610 0.07062147 0.04237288</span></span>
<span><span class="co">## [2,] 0.07062147 0.19209040 0.07909605</span></span>
<span><span class="co">## [3,] 0.04237288 0.07909605 0.24576271</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ,,3,1</span></span>
<span><span class="co">##            [,1]       [,2]       [,3]</span></span>
<span><span class="co">## [1,] 0.25531915 0.14539007 0.03546099</span></span>
<span><span class="co">## [2,] 0.03546099 0.12411348 0.21276596</span></span>
<span><span class="co">## [3,] 0.03546099 0.06382979 0.09219858</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ,,1,2</span></span>
<span><span class="co">##            [,1]       [,2]       [,3]</span></span>
<span><span class="co">## [1,] 0.20416667 0.11250000 0.01666667</span></span>
<span><span class="co">## [2,] 0.20416667 0.11250000 0.01666667</span></span>
<span><span class="co">## [3,] 0.20416667 0.11250000 0.01666667</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ,,2,2</span></span>
<span><span class="co">##            [,1]       [,2]       [,3]</span></span>
<span><span class="co">## [1,] 0.18604651 0.08637874 0.02657807</span></span>
<span><span class="co">## [2,] 0.08637874 0.19933555 0.04651163</span></span>
<span><span class="co">## [3,] 0.02657807 0.04651163 0.29568106</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ,,3,2</span></span>
<span><span class="co">##            [,1]       [,2]       [,3]</span></span>
<span><span class="co">## [1,] 0.19393939 0.13333333 0.07272727</span></span>
<span><span class="co">## [2,] 0.07272727 0.13939394 0.20606061</span></span>
<span><span class="co">## [3,] 0.03636364 0.06060606 0.08484848</span></span></code></pre>
<p>By using <code><a href="../reference/regularize.html">regularize()</a></code> before extracting counts, you can
take advantage of the block and parallel processing functionality from
aggregating with <code><a href="../reference/aggHicMatrices.html">aggHicMatrices()</a></code>:</p>
<div class="sourceCode" id="cb132"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/regularize.html">regularize</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">ija</span>, ndim<span class="op">=</span><span class="fu"><a href="https://phanstiellab.github.io/plotgardener/reference/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>, nBlocks<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/aggHicMatrices.html">aggHicMatrices</a></span><span class="op">(</span>nBlocks<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## / Reading and realizing block 1/1 of file 1/2 ... OK</span></span>
<span><span class="co">## \ Processing it ... OK</span></span>
<span><span class="co">## / Reading and realizing block 1/1 of file 2/2 ... OK</span></span>
<span><span class="co">## \ Processing it ... OK</span></span>
<span><span class="co">## / reading and realizing block 1/1 ... ok</span></span>
<span><span class="co">## \ processing it ... ok</span></span></code></pre>
<pre><code><span><span class="co">## &lt;3 x 3&gt; DelayedMatrix object of type "double":</span></span>
<span><span class="co">##           [,1]      [,2]      [,3]</span></span>
<span><span class="co">## [1,] 1.2594470 0.6167168 0.2166369</span></span>
<span><span class="co">## [2,] 0.7113643 0.8359265 0.5839320</span></span>
<span><span class="co">## [3,] 0.5869514 0.4310367 0.7579886</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="other-pullhic-arguments">Other pullHic* arguments<a class="anchor" aria-label="anchor" href="#other-pullhic-arguments"></a>
</h2>
<p>The previous sections provided examples of using
<code><a href="../reference/pullHicPixels.html">pullHicPixels()</a></code> and <code><a href="../reference/pullHicMatrices.html">pullHicMatrices()</a></code>, for
extracting Hi-C pixels and count matrices, respectively. These functions
require three mandatory arguments: <code>x</code> for interactions,
<code>files</code> for <code>.hic</code> file paths, and
<code>binSize</code> for the Hi-C resolution.</p>
<p>Additionally, the remaining arguments allow for greater control over
the Hi-C data extraction process. These arguments control the type of
Hi-C data to be extracted, the efficiency of extraction, and specify the
storage location for the extracted data.</p>
<p>In this section we delve deeper into the utilization of these
arguments to effectively extract Hi-C data.</p>
<div class="section level3">
<h3 id="normalization-and-matrix-type">Normalization and matrix type<a class="anchor" aria-label="anchor" href="#normalization-and-matrix-type"></a>
</h3>
<p>The <code>norm</code> and <code>matrix</code> arguments are passed to
<code>strawr</code> during the extraction step.</p>
<p><code>norm</code> refers to the Hi-C normalization and is limited to
pre-computed normalizations in the <code>.hic</code> file. Use the
<code><a href="https://rdrr.io/pkg/strawr/man/readHicNormTypes.html" class="external-link">readHicNormTypes()</a></code> function from the <code>strawr</code>
package to see available normalizations.</p>
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pullHicPixels.html">pullHicPixels</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gi</span>, files<span class="op">=</span><span class="va">hicFiles</span>, binSize<span class="op">=</span><span class="fl">100e3</span>, norm<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;"> in `.checkStrawArgs()`:</span></span></span>
<span><span class="co">## <span style="color: #BBBB00;">!</span> `norm` must be one of "VC_SQRT", "KR", "NONE", or "VC", not "none".</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Did you mean "NONE"?</span></span></code></pre>
<p>The <code>matrix</code> argument specifies the type of values to
extract. The default is the “observed” contact frequency values. Other
options include “expected” contact frequency and the “oe” or
observed/expected values. For an in-depth description of these matrix
types see <a href="https://doi.org/10.1016/j.cels.2016.07.002" class="external-link">Durand et
al. 2016</a></p>
<div class="sourceCode" id="cb137"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pullHicPixels.html">pullHicPixels</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gi</span>, files<span class="op">=</span><span class="va">hicFiles</span>, binSize<span class="op">=</span><span class="fl">100e3</span>, matrix<span class="op">=</span><span class="st">"oe"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## &lt;4 x 2&gt; DelayedMatrix object of type "double":</span></span>
<span><span class="co">##           hic1      hic2</span></span>
<span><span class="co">## [1,] 1.0564467 1.1543123</span></span>
<span><span class="co">## [2,] 1.2557763 1.3192140</span></span>
<span><span class="co">## [3,] 0.9188343 0.5032488</span></span>
<span><span class="co">## [4,] 1.0974965 0.7548732</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="the-half-parameter">The <code>half</code> parameter<a class="anchor" aria-label="anchor" href="#the-half-parameter"></a>
</h3>
<p>The Hi-C matrix is a square, symmetric matrix that captures the
frequency of all pair-wise interactions between genomic loci. In other
words, each point in a Hi-C matrix represents the interaction frequency
between a two pairs, or anchors, of genomic regions.</p>
<p>In <code>mariner</code>, the Hi-C matrix is oriented with the origin
(lowest genomic coordinates) in the upper left corner with linear
genomic position increasing down and to the right.</p>
<p><img src="img/origin.png" width="50%" style="display: block; margin: auto;"></p>
<p>The first anchor, or genomic locus, corresponds on the vertical axis
(rows of matrix) while the second anchor corresponds to the horizontal
axis (columns of the matrix). Together, these anchors specify a
two-dimensional region on the Hi-C matrix.</p>
<p><img src="img/anchors.png" width="50%" style="display: block; margin: auto;"></p>
<p>The relative positions of these anchors determines from which “half”
of the matrix data is extracted. When the genomic position of the first
anchor is less than the second anchor the region resides in the upper
trianglar.</p>
<p><img src="img/upper.png" width="75%" style="display: block; margin: auto;"></p>
<p>When the genomic position of the first anchor is greater than the
second anchor the region resides in the lower triangular.</p>
<p><img src="img/lower.png" width="75%" style="display: block; margin: auto;"></p>
<p>If the first and second anchors are equal then the region is on the
diagonal and the values will be mirrored across the diagonal.</p>
<p><img src="img/diagonal.png" width="50%" style="display: block; margin: auto;"></p>
<p>To summarize:</p>
<ul>
<li>first &lt; second - upper triangular</li>
<li>first &gt; second - lower triangular</li>
<li>first == second - mirrored diagonal</li>
</ul>
<p>The <code>half</code> parameter controls which portion of the Hi-C
matrix is returned, regardless of anchor position. When
<code>half="upper"</code> only upper-triangular data is returned. When
<code>half="lower"</code> only lower-triangular data is returned.
<code>half="both"</code> returns upper and lower triangular data.
<code>NA</code> values are returned for portions of the matrix that do
not match the region of the matrix specified with <code>half</code>. The
figure and code below show how data are returned for a region that
resides on the diagonal, crossing into both the upper and lower
triangular of the Hi-C matrix.</p>
<p><img src="img/diagonalHalf.png" width="75%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb139"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Hic file</span></span>
<span><span class="va">hic</span> <span class="op">&lt;-</span> <span class="fu">marinerData</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/marinerData/man/LEUK_HEK_PJA27_inter_30.hic.html" class="external-link">LEUK_HEK_PJA27_inter_30.hic</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## On-diagonal interaction</span></span>
<span><span class="va">diagonal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_ginteractions.html">as_ginteractions</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span>text<span class="op">=</span><span class="st">"</span></span>
<span><span class="st">    1 51000000 51300000 1 51000000 51300000</span></span>
<span><span class="st">"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## half="upper"</span></span>
<span><span class="fu"><a href="../reference/pullHicMatrices.html">pullHicMatrices</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">diagonal</span>, files<span class="op">=</span><span class="va">hic</span>, binSize<span class="op">=</span><span class="fl">100e3</span>, half<span class="op">=</span><span class="st">"upper"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## &lt;3 x 3 x 1 x 1&gt; DelayedArray object of type "double":</span></span>
<span><span class="co">## ,,1,EH8088</span></span>
<span><span class="co">##      [,1] [,2] [,3]</span></span>
<span><span class="co">## [1,]   53   15    5</span></span>
<span><span class="co">## [2,]   NA   68   19</span></span>
<span><span class="co">## [3,]   NA   NA   69</span></span></code></pre>
<div class="sourceCode" id="cb141"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## half="lower"</span></span>
<span><span class="fu"><a href="../reference/pullHicMatrices.html">pullHicMatrices</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">diagonal</span>, files<span class="op">=</span><span class="va">hic</span>, binSize<span class="op">=</span><span class="fl">100e3</span>, half<span class="op">=</span><span class="st">"lower"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## &lt;3 x 3 x 1 x 1&gt; DelayedArray object of type "double":</span></span>
<span><span class="co">## ,,1,EH8088</span></span>
<span><span class="co">##      [,1] [,2] [,3]</span></span>
<span><span class="co">## [1,]   53   NA   NA</span></span>
<span><span class="co">## [2,]   15   68   NA</span></span>
<span><span class="co">## [3,]    5   19   69</span></span></code></pre>
<div class="sourceCode" id="cb143"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## half="both"</span></span>
<span><span class="fu"><a href="../reference/pullHicMatrices.html">pullHicMatrices</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">diagonal</span>, files<span class="op">=</span><span class="va">hic</span>, binSize<span class="op">=</span><span class="fl">100e3</span>, half<span class="op">=</span><span class="st">"both"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## &lt;3 x 3 x 1 x 1&gt; DelayedArray object of type "double":</span></span>
<span><span class="co">## ,,1,EH8088</span></span>
<span><span class="co">##      [,1] [,2] [,3]</span></span>
<span><span class="co">## [1,]   53   15    5</span></span>
<span><span class="co">## [2,]   15   68   19</span></span>
<span><span class="co">## [3,]    5   19   69</span></span></code></pre>
<p>Since chromosomes have no inherent order in linear genomic space, the
<code>half</code> parameter is ignored for interchromosomal
interactions. <code><a href="../reference/pullHicPixels.html">pullHicPixels()</a></code> behaves the same way with the
<code>half</code> parameter.</p>
</div>
<div class="section level3">
<h3 id="changing-blocksize-for-large-data">Changing <code>blockSize</code> for large data<a class="anchor" aria-label="anchor" href="#changing-blocksize-for-large-data"></a>
</h3>
<p><code><a href="../reference/pullHicPixels.html">pullHicPixels()</a></code> and <code><a href="../reference/pullHicMatrices.html">pullHicMatrices()</a></code> allow
you to tune the efficiency and memory-usage of Hi-C data extraction by
grouping nearby interactions into blocks. The block data is then loaded
into memory, assigned to interactions, and then written to back to disk
as an HDF5 file. You can modify the <code>blockSize</code> (in
base-pairs) to control the size and number of blocks that are extracted.
Pulling larger blocks decreases run-time, but requires more RAM to store
these data while smaller blocks increase run-time, but allows you to
extract counts from large Hi-C files that may not otherwise fit into
memory.</p>
<p>Adjustments to <code>blockSize</code> can optimize the efficiency of
extraction. There is a trade-off between the size of the block and the
number of iterations required to extract all interactions. The size and
placement of interactions on the genome also affects the
<code>blockSize</code>. For example, a worst-case performance scenario
would be extracting each interaction individually (setting
<code>blockSize</code> to the width of the interaction). Generally, it
is most efficient to extract the largest blocks possible. When your data
is small enough, pulling whole chromosomes is usually most efficient.
However, the optimal <code>blockSize</code> is highly dependent on both
the interactions and <code>.hic</code> files, so you may want to
experiment with this parameter to find the best trade-off for your
data.</p>
<p>The <code>compressionLevel</code> and <code>chunkSize</code>
parameters control the way extracted data is written back to the
HDF5-file. See <code><a href="../reference/pullHicMatrices.html">?pullHicMatrices</a></code> or
<code><a href="../reference/pullHicPixels.html">?pullHicPixels</a></code> for a more in-depth description of these
parameters.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Eric Davis, Sarah Parker.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
