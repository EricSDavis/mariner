% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/AllGenerics.R, R/methods-adjustEnrichment.R
\name{plotEnrichment}
\alias{plotEnrichment}
\alias{adjustEnrichment}
\alias{adjustEnrichment,DelayedMatrix_OR_matrix,GInteractions-method}
\alias{plotEnrichment,numeric,GInteractions-method}
\title{Adjust loop enrichment to remove distance-
dependent effect.}
\usage{
plotEnrichment(scores, interactions, k = 25, nknots = 10, plot = TRUE)

adjustEnrichment(x, interactions, k = 25, nknots = 10)

\S4method{adjustEnrichment}{DelayedMatrix_OR_matrix,GInteractions}(x, interactions, k = 25, nknots = 10)

\S4method{plotEnrichment}{numeric,GInteractions}(scores, interactions, k = 25, nknots = 10, plot = TRUE)
}
\arguments{
\item{scores}{Numeric vector of enrichment scores.}

\item{interactions}{A GInteractions Object containing
the interactions used to calculate enrichment scores.}

\item{k}{Number of observations for rolling window.}

\item{nknots}{integer or function giving the number
of knots to use see `?smooth.spline` for more info.}

\item{plot}{Boolean (default=FALSE), of whether to
show diagnostic plot.}

\item{x}{A DelayedMatrix or matrix with enrichment
scores.}
}
\value{
A DelayedMatrix of enrichment scores where rows
 are loops and columns are Hi-C files.

A plot (and associated data) for visualizing
 loop enrichment before and after distance adjustment.
}
\description{
Adjust loop enrichment to remove distance-
dependent effect.

Show diagnostic plot of loop enrichment before
and after distance adjustment.
}
\examples{

## Read .hic file paths
hicFiles <-
    system.file("extdata/test_hic", package="mariner") |>
    list.files(pattern=".hic", full.names=TRUE)

## Read in loops as GInteractions object
loops <-
    system.file("extdata", package="mariner") |>
    list.files(pattern="WT.*Loops.txt", full.names=TRUE) |>
    read.table(header=TRUE, nrows=1000) |>
    as_ginteractions(keep.extra.columns=FALSE)

## Removes the "chr" prefix for compatibility
## with the preprocessed hic files
GenomeInfoDb::seqlevelsStyle(loops) <- 'ENSEMBL'

## Calculate loop enrichment
enrich <- calcLoopEnrichment(
    x=binPairs(loops, 100e03),
    files=hicFiles
)

adjustEnrichment(enrich, loops)


plotEnrichment(enrich[,1], loops)

}
